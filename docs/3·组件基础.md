# 3·组件基础



## what’s this

组件是 React 的主要功能，使用 React 就是在用组件。

组件表示页面中的部分功能，通过组合多个组件实现完整的页面功能，组件可复用、独立、可组合。

## 创建组件

### 函数创建

使用 JS 的函数（或箭头函数）创建的组件。

函数名称必须以大写字母开头（据此区分组件和普通的 React 元素），必须有返回值，表示该组件的结构，如果返回值为 null，表示不渲染任何内容。

渲染函数组件：用函数名作为组件标签名，组件标签可以是单标签也可以是双标签。

```jsx
function Hello() {
    return (
        <div>hello world！</div>
    )
}
ReactDOM.render(<Hello />, root)
```

### 类创建

使用 ES6 的 class 创建的组件。

类名称必须以大写字母开头，应该继承 React.Component 父类，从而可以使用父类中提供的方法或属性。必须提供 render() 方法，render() 方法必须有返回值，表示该组件的结构。

```jsx
class Hello extends React.Component {
    render() {
        return <div>Hello Class Component!</div>
    }
}
ReactDOM.render(<Hello />, root)
```

## 抽离组件

组件作为一个独立的个体，一般都会放到一个单独的 JS 文件中。

```jsx
// Hello.js 组件文件
import React from 'react'
class Hello extends React.Component {
    render() {
        return <div>Hello Class Component!</div>
    }
}
// 导出Hello组件
export default Hello

// index.js 组件文件
import Hello from './Hello'
// 渲染导入的Hello组件
ReactDOM.render(<Hello />, root)
```

## 事件处理

### 绑定事件

React 事件绑定语法与 DOM 事件语法相似。

语法：`on + 事件名称 = {事件处理程序}`，如：`onClick={() => {}}`

React 事件采用驼峰命名法，如：onMouseEnter、onFocus…

```jsx
// 在函数组件中绑定事件
function App() {
    function handleClick() {
        console.log('单击事件触发了')
    }
    return (
        <button onClick={handleClick}>点我</button>
    )
}

// 在类组件中绑定事件
class App extends React.Component {
    handleClick() {
        console.log('单击事件触发了')
    }
    render() {
        return (
            <button onClick={this.handleClick}></button>
        )
    }
}
```

### 事件对象

通过事件处理程序的参数获取到事件对象，React 中的事件对象又称合成事件，合成事件兼容所有浏览器。

```jsx
function handleClick(e) {
    // 阻止事件默认行为
    e.preventDefault()
    console.log('事件对象', e)
}
<a onClick={handleClick}>点我，不会跳转页面</a>
```

## 有/无状态组件

函数组件又称无状态组件。函数组件没有自己的状态，只负责数据展示（静）。

类组件又称有状态组件。类组件有自己的状态，负责更新 UI，让页面动起来。

### state

状态（state）即数据，是组件内部的私有数据，只能在组件内部使用。

state 的值是对象，表示一个组件中可以有多个数据。

获取状态：`this.state`

```jsx
class Hello extends React.Component {
    
    // constructor() {
    //     super()
    //     // 初始化state
    //     this.state = {
    //         count: 0
    //     }
    // }

    // 简化语法
    state = {
        count: 0
    }   
    
    render() {
        return (
            <div>有状态组件,{this.state.count}</div>
        )
    }
}

```

### setState()

状态是可变的。不能直接修改 state 中的值。

语法：`this.setState({ 要修改的数据 })`

setState() 作用：修改 state、更新UI.

```js
// 正确
this.setState({
    count: this.state.count + 1
})

// 错误
this.state.count += 1
```

## 抽离事件处理程序

JSX 中掺杂过多 JS 逻辑代码，会显得非常混乱，推荐将逻辑抽离到单独的方法中，保证 JSX 结构清晰。

原因：事件处理程序中 this 的值为 undefined.

希望：this 指向组件实例（render方法中的this即为组件实例）。
